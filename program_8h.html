<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>uMIDI: src/lib/program.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">uMIDI
   </div>
   <div id="projectbrief">The swiss army knife for quick and easy developement of MIDI applications.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_c85d3e3c5052e9ad9ce18c6863244a25.html">lib</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">program.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Program storage API.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdint.h&gt;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for program.h:</div>
<div class="dyncontent">
<div class="center"><img src="program_8h__incl.png" border="0" usemap="#src_2lib_2program_8h" alt=""/></div>
<map name="src_2lib_2program_8h" id="src_2lib_2program_8h">
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="program_8h__dep__incl.png" border="0" usemap="#src_2lib_2program_8hdep" alt=""/></div>
<map name="src_2lib_2program_8hdep" id="src_2lib_2program_8hdep">
<area shape="rect" id="node3" href="program_8c.html" title="Program storage module implementation." alt="" coords="5,83,123,112"/></map>
</div>
</div>
<p><a href="program_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structprogram.html">program</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Data structure for program information.  <a href="structprogram.html#details">More...</a><br/></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a5574b652f173bfea8b31319decdc259a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="program_8h.html#a5574b652f173bfea8b31319decdc259a">PROGRAM_COUNT</a>&#160;&#160;&#160;120</td></tr>
<tr class="memdesc:a5574b652f173bfea8b31319decdc259a"><td class="mdescLeft">&#160;</td><td class="mdescRight">The maximum number of programs that can be stored.  <a href="#a5574b652f173bfea8b31319decdc259a"></a><br/></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab205027e337947b622b2f9d83014f798"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="program_8h.html#ab205027e337947b622b2f9d83014f798">copy_current_bank_to</a> (uint8_t target_bank)</td></tr>
<tr class="memdesc:ab205027e337947b622b2f9d83014f798"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copies all programs in the current bank to another bank.  <a href="#ab205027e337947b622b2f9d83014f798"></a><br/></td></tr>
<tr class="memitem:a6ba941d0654d34892d771caa05411fc9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="program_8h.html#a6ba941d0654d34892d771caa05411fc9">copy_current_program_to</a> (uint8_t target_program)</td></tr>
<tr class="memdesc:a6ba941d0654d34892d771caa05411fc9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copies the current program to the specified position in memory.  <a href="#a6ba941d0654d34892d771caa05411fc9"></a><br/></td></tr>
<tr class="memitem:adac7511ca1a907abf09fb3aab4f22eeb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="program_8h.html#adac7511ca1a907abf09fb3aab4f22eeb">enter_program</a> (uint8_t number)</td></tr>
<tr class="memdesc:adac7511ca1a907abf09fb3aab4f22eeb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Loads and executes the specified program.  <a href="#adac7511ca1a907abf09fb3aab4f22eeb"></a><br/></td></tr>
<tr class="memitem:ab624827da14b4002a8518353a27830ec"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="program_8h.html#ab624827da14b4002a8518353a27830ec">init_program_module</a> (uint16_t <a class="el" href="program_8c.html#ac83d45dba66d4665ece8e157b1d21e51">program_initializer</a>, void(*execute_program_callback)(uint16_t <a class="el" href="unionprogram__data.html">program_data</a>))</td></tr>
<tr class="memdesc:ab624827da14b4002a8518353a27830ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the program storage module.  <a href="#ab624827da14b4002a8518353a27830ec"></a><br/></td></tr>
<tr class="memitem:a7eea6fd99a25d7c2ac95471a6ea3dd8a"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="program_8h.html#a7eea6fd99a25d7c2ac95471a6ea3dd8a">read_program_data</a> (uint8_t number)</td></tr>
<tr class="memdesc:a7eea6fd99a25d7c2ac95471a6ea3dd8a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads a program data word from the specified position in memory.  <a href="#a7eea6fd99a25d7c2ac95471a6ea3dd8a"></a><br/></td></tr>
<tr class="memitem:ad6f39892de13f695b9d0bbc5673fa216"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="program_8h.html#ad6f39892de13f695b9d0bbc5673fa216">update_current_program</a> (uint16_t <a class="el" href="unionprogram__data.html">program_data</a>)</td></tr>
<tr class="memdesc:ad6f39892de13f695b9d0bbc5673fa216"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates and stores the current program.  <a href="#ad6f39892de13f695b9d0bbc5673fa216"></a><br/></td></tr>
<tr class="memitem:a23283a77ea4b32c1c3f2a1448a4b2772"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="program_8h.html#a23283a77ea4b32c1c3f2a1448a4b2772">wipe_current_bank</a> (void)</td></tr>
<tr class="memdesc:a23283a77ea4b32c1c3f2a1448a4b2772"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reinitializes all programs in the current bank.  <a href="#a23283a77ea4b32c1c3f2a1448a4b2772"></a><br/></td></tr>
<tr class="memitem:af2f8613074a93fab7055b60a21faf135"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="program_8h.html#af2f8613074a93fab7055b60a21faf135">wipe_current_program</a> (void)</td></tr>
<tr class="memdesc:af2f8613074a93fab7055b60a21faf135"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reinitializes the currently loaded program.  <a href="#af2f8613074a93fab7055b60a21faf135"></a><br/></td></tr>
<tr class="memitem:a787dec13a600952b3704aaf1e1f9220a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="program_8h.html#a787dec13a600952b3704aaf1e1f9220a">write_program</a> (uint8_t number, uint16_t data)</td></tr>
<tr class="memdesc:a787dec13a600952b3704aaf1e1f9220a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stores a given program data word in the specified position in memory.  <a href="#a787dec13a600952b3704aaf1e1f9220a"></a><br/></td></tr>
</table>
<a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Program storage API. </p>
<p>This module takes care of loading, storing, copying and wiping program data. The programs are stored in EEPROM as 16-bit words - providing a generic container for flags, numbers - whatever is suitable for your program. It is advisable to define a <code>union</code> for easier access of these components in your application code - for example something like </p>
<div class="fragment"><div class="line"><span class="keyword">union </span><a class="code" href="unionprogram__data.html">program_data</a> = {</div>
<div class="line">    uint16_t <a class="code" href="unionprogram__data.html#ad97b7ccd7b787dd4badf1bcc082edca3">word</a>;</div>
<div class="line">    <span class="keyword">struct </span>{</div>
<div class="line">        <span class="keywordtype">bool</span> flag0 : 1;</div>
<div class="line">        <span class="keywordtype">bool</span> flag1 : 1;</div>
<div class="line">        <span class="keywordtype">bool</span> flag2 : 1;</div>
<div class="line">    } bit;</div>
<div class="line">}</div>
</div><!-- fragment --><p> The programs are grouped into twelve banks of ten programs each - leaving 128 bits of EEPROM for other application specific data. Applications must implement and register a callback for program execution, which does whatever is necessary when a new program is loaded. </p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="program_8h.html#ab624827da14b4002a8518353a27830ec" title="Initializes the program storage module.">init_program_module</a> </dd></dl>
</div><h2>Macro Definition Documentation</h2>
<a class="anchor" id="a5574b652f173bfea8b31319decdc259a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PROGRAM_COUNT&#160;&#160;&#160;120</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The maximum number of programs that can be stored. </p>

</div>
</div>
<h2>Function Documentation</h2>
<a class="anchor" id="ab205027e337947b622b2f9d83014f798"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void copy_current_bank_to </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>target_bank</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Copies all programs in the current bank to another bank. </p>
<p>Irreversibly overwrites all programs in the target bank. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">target_bank</td><td>Target bank number [0..11]. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a6ba941d0654d34892d771caa05411fc9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void copy_current_program_to </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>target_program</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Copies the current program to the specified position in memory. </p>
<p>Irreversibly overwrites the target program. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">target_program</td><td>Target program number [0..119]. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="adac7511ca1a907abf09fb3aab4f22eeb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void enter_program </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>number</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Loads and executes the specified program. </p>
<p>Reads the new program data from EEPROM, updates the internal state and calls the registered callback function, which executes the program. If the specified program number is the same as the stored current program number, this function does nothing. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">number</td><td>Program number [0..119]. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="program_8h.html#ab624827da14b4002a8518353a27830ec" title="Initializes the program storage module.">init_program_module</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ab624827da14b4002a8518353a27830ec"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void init_program_module </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>program_initializer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(uint16_t <a class="el" href="unionprogram__data.html">program_data</a>)&#160;</td>
          <td class="paramname"><em>execute_program_callback</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the program storage module. </p>
<p>Stores the specified program data initialization word, used in the wipe functions and registers the provided callback function, which is executed whenever the current program data word is updated either by wiping the program or loading a new one. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">program_initializer</td><td>On wiping, programs are initialized with this value. </td></tr>
    <tr><td class="paramname">execute_program_callback</td><td>Callback for program execution. This procedure is called with the program configuration data that was read from memory as the parameter <code><a class="el" href="unionprogram__data.html">program_data</a></code>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="program_8h.html#af2f8613074a93fab7055b60a21faf135" title="Reinitializes the currently loaded program.">wipe_current_program</a> </dd>
<dd>
<a class="el" href="program_8h.html#adac7511ca1a907abf09fb3aab4f22eeb" title="Loads and executes the specified program.">enter_program</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a7eea6fd99a25d7c2ac95471a6ea3dd8a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t read_program_data </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>number</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads a program data word from the specified position in memory. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">number</td><td>Program number [0..119]. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ad6f39892de13f695b9d0bbc5673fa216"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void update_current_program </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>program_data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates and stores the current program. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname"><a class="el" href="unionprogram__data.html">program_data</a></td><td>the new configuration </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a23283a77ea4b32c1c3f2a1448a4b2772"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void wipe_current_bank </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reinitializes all programs in the current bank. </p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="program_8h.html#af2f8613074a93fab7055b60a21faf135" title="Reinitializes the currently loaded program.">wipe_current_program</a> </dd></dl>

</div>
</div>
<a class="anchor" id="af2f8613074a93fab7055b60a21faf135"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void wipe_current_program </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reinitializes the currently loaded program. </p>
<p>Updates the internal program data word with the initializer, stores it and executes the initialized program. </p>

</div>
</div>
<a class="anchor" id="a787dec13a600952b3704aaf1e1f9220a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void write_program </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stores a given program data word in the specified position in memory. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">number</td><td>Program number [0..119]. </td></tr>
    <tr><td class="paramname">data</td><td>Program data as 16-bit word. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Mar 6 2016 16:50:06 for uMIDI by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.1.2
</small></address>
</body>
</html>
