<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>uMIDI: /mnt/c/repositories/stuff/uMIDI/software/src/lib/background_tasks.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">uMIDI
   </div>
   <div id="projectbrief">The swiss army knife for quick and easy developement of MIDI applications.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_c8fa76d8dc1b9e06ff8aeb3121608b1b.html">software</a></li><li class="navelem"><a class="el" href="dir_0a6976b261bfea925410a9d3b510969e.html">src</a></li><li class="navelem"><a class="el" href="dir_85743a6d44e2a34b0cf5e56859c4c51a.html">lib</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">background_tasks.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Background task scheduler.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdint.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for background_tasks.h:</div>
<div class="dyncontent">
<div class="center"><img src="background__tasks_8h__incl.png" border="0" usemap="#_2mnt_2c_2repositories_2stuff_2uMIDI_2software_2src_2lib_2background__tasks_8h" alt=""/></div>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="background__tasks_8h__dep__incl.png" border="0" usemap="#_2mnt_2c_2repositories_2stuff_2uMIDI_2software_2src_2lib_2background__tasks_8hdep" alt=""/></div>
<map name="_2mnt_2c_2repositories_2stuff_2uMIDI_2software_2src_2lib_2background__tasks_8hdep" id="_2mnt_2c_2repositories_2stuff_2uMIDI_2software_2src_2lib_2background__tasks_8hdep">
<area shape="rect" id="node2" href="background__tasks_8c.html" title="Background task scheduler. " alt="" coords="5,109,204,165"/>
<area shape="rect" id="node3" href="serial__communication_8c.html" title="Implementation of the serial communication module. " alt="" coords="227,109,451,165"/>
<area shape="rect" id="node4" href="tests_8c.html" title="/mnt/c/repositories\l/stuff/uMIDI/software\l/src/lib/tests.c" alt="" coords="475,109,633,165"/>
<area shape="rect" id="node5" href="wave_8c.html" title="Waveform function generator. " alt="" coords="657,109,814,165"/>
</map>
</div>
</div>
<p><a href="background__tasks_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:aca12ec03d86eb5ef061e7a94b02b0ac0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="background__tasks_8h.html#aca12ec03d86eb5ef061e7a94b02b0ac0">F_TIMER</a>&#160;&#160;&#160;20000</td></tr>
<tr class="memdesc:aca12ec03d86eb5ef061e7a94b02b0ac0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Frequency of the CPU timer used in by the task scheduler in [Hz].  <a href="#aca12ec03d86eb5ef061e7a94b02b0ac0">More...</a><br /></td></tr>
<tr class="separator:aca12ec03d86eb5ef061e7a94b02b0ac0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ccb08d3b903865a450dc2b4633d2d97"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="background__tasks_8h.html#a0ccb08d3b903865a450dc2b4633d2d97">F_TASK_FAST</a>&#160;&#160;&#160;<a class="el" href="background__tasks_8h.html#aca12ec03d86eb5ef061e7a94b02b0ac0">F_TIMER</a></td></tr>
<tr class="memdesc:a0ccb08d3b903865a450dc2b4633d2d97"><td class="mdescLeft">&#160;</td><td class="mdescRight">High priority task: Called every 50 us (20 kHz)  <a href="#a0ccb08d3b903865a450dc2b4633d2d97">More...</a><br /></td></tr>
<tr class="separator:a0ccb08d3b903865a450dc2b4633d2d97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aadd0736a68458905fa7bca00d7f5f9be"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="background__tasks_8h.html#aadd0736a68458905fa7bca00d7f5f9be">F_TASK_MID</a>&#160;&#160;&#160;(<a class="el" href="background__tasks_8h.html#a0ccb08d3b903865a450dc2b4633d2d97">F_TASK_FAST</a> / 20)</td></tr>
<tr class="memdesc:aadd0736a68458905fa7bca00d7f5f9be"><td class="mdescLeft">&#160;</td><td class="mdescRight">Medium priority task: Called every 1 ms (1 kHz)  <a href="#aadd0736a68458905fa7bca00d7f5f9be">More...</a><br /></td></tr>
<tr class="separator:aadd0736a68458905fa7bca00d7f5f9be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cf2a4ef4c846f63e307f38c33bb5e30"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="background__tasks_8h.html#a6cf2a4ef4c846f63e307f38c33bb5e30">F_TASK_SLOW</a>&#160;&#160;&#160;(<a class="el" href="background__tasks_8h.html#aadd0736a68458905fa7bca00d7f5f9be">F_TASK_MID</a> / 10)</td></tr>
<tr class="memdesc:a6cf2a4ef4c846f63e307f38c33bb5e30"><td class="mdescLeft">&#160;</td><td class="mdescRight">Low priority task: Called every 10 ms (100 Hz)  <a href="#a6cf2a4ef4c846f63e307f38c33bb5e30">More...</a><br /></td></tr>
<tr class="separator:a6cf2a4ef4c846f63e307f38c33bb5e30"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:af89fe664694e3154a340884bcd0c645e"><td class="memItemLeft" align="right" valign="top">typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="background__tasks_8h.html#af89fe664694e3154a340884bcd0c645e">background_task_t</a>) (void)</td></tr>
<tr class="memdesc:af89fe664694e3154a340884bcd0c645e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Data type for background task pointers.  <a href="#af89fe664694e3154a340884bcd0c645e">More...</a><br /></td></tr>
<tr class="separator:af89fe664694e3154a340884bcd0c645e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a59b8f1c0605d7525987674f81ac7669b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="background__tasks_8h.html#a59b8f1c0605d7525987674f81ac7669b">process_background_tasks</a> (void)</td></tr>
<tr class="memdesc:a59b8f1c0605d7525987674f81ac7669b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Invokes registered background tasks if certain conditions are met.  <a href="#a59b8f1c0605d7525987674f81ac7669b">More...</a><br /></td></tr>
<tr class="separator:a59b8f1c0605d7525987674f81ac7669b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a100bceea6009951a25008a187393605c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="background__tasks_8h.html#a100bceea6009951a25008a187393605c">init_background_tasks</a> (<a class="el" href="background__tasks_8h.html#af89fe664694e3154a340884bcd0c645e">background_task_t</a> high_freq_tasks[], uint8_t high_freq_tasks_size, <a class="el" href="background__tasks_8h.html#af89fe664694e3154a340884bcd0c645e">background_task_t</a> mid_freq_tasks[], uint8_t mid_freq_tasks_size, <a class="el" href="background__tasks_8h.html#af89fe664694e3154a340884bcd0c645e">background_task_t</a> low_freq_tasks[], uint8_t low_freq_tasks_size)</td></tr>
<tr class="memdesc:a100bceea6009951a25008a187393605c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the background task scheduler.  <a href="#a100bceea6009951a25008a187393605c">More...</a><br /></td></tr>
<tr class="separator:a100bceea6009951a25008a187393605c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Background task scheduler. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a0ccb08d3b903865a450dc2b4633d2d97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ccb08d3b903865a450dc2b4633d2d97">&#9670;&nbsp;</a></span>F_TASK_FAST</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define F_TASK_FAST&#160;&#160;&#160;<a class="el" href="background__tasks_8h.html#aca12ec03d86eb5ef061e7a94b02b0ac0">F_TIMER</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>High priority task: Called every 50 us (20 kHz) </p>

</div>
</div>
<a id="aadd0736a68458905fa7bca00d7f5f9be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aadd0736a68458905fa7bca00d7f5f9be">&#9670;&nbsp;</a></span>F_TASK_MID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define F_TASK_MID&#160;&#160;&#160;(<a class="el" href="background__tasks_8h.html#a0ccb08d3b903865a450dc2b4633d2d97">F_TASK_FAST</a> / 20)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Medium priority task: Called every 1 ms (1 kHz) </p>

</div>
</div>
<a id="a6cf2a4ef4c846f63e307f38c33bb5e30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cf2a4ef4c846f63e307f38c33bb5e30">&#9670;&nbsp;</a></span>F_TASK_SLOW</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define F_TASK_SLOW&#160;&#160;&#160;(<a class="el" href="background__tasks_8h.html#aadd0736a68458905fa7bca00d7f5f9be">F_TASK_MID</a> / 10)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Low priority task: Called every 10 ms (100 Hz) </p>

</div>
</div>
<a id="aca12ec03d86eb5ef061e7a94b02b0ac0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca12ec03d86eb5ef061e7a94b02b0ac0">&#9670;&nbsp;</a></span>F_TIMER</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define F_TIMER&#160;&#160;&#160;20000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Frequency of the CPU timer used in by the task scheduler in [Hz]. </p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="af89fe664694e3154a340884bcd0c645e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af89fe664694e3154a340884bcd0c645e">&#9670;&nbsp;</a></span>background_task_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(* background_task_t) (void)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Data type for background task pointers. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a100bceea6009951a25008a187393605c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a100bceea6009951a25008a187393605c">&#9670;&nbsp;</a></span>init_background_tasks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void init_background_tasks </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="background__tasks_8h.html#af89fe664694e3154a340884bcd0c645e">background_task_t</a>&#160;</td>
          <td class="paramname"><em>high_freq_tasks</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>high_freq_tasks_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="background__tasks_8h.html#af89fe664694e3154a340884bcd0c645e">background_task_t</a>&#160;</td>
          <td class="paramname"><em>mid_freq_tasks</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>mid_freq_tasks_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="background__tasks_8h.html#af89fe664694e3154a340884bcd0c645e">background_task_t</a>&#160;</td>
          <td class="paramname"><em>low_freq_tasks</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>low_freq_tasks_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the background task scheduler. </p>
<p>Configures CPU timer 0 to provide the main clock for the background task scheduler and registers the tasks to be invoked cyclically. The tasks are grouped into three levels of priority. High priority tasks are executed more frequently. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">high_freq_tasks</td><td>an array of function pointers to high frequency tasks </td></tr>
    <tr><td class="paramname">high_freq_tasks_size</td><td>number of high frequency tasks </td></tr>
    <tr><td class="paramname">mid_freq_tasks</td><td>an array of function pointers to medium frequency tasks </td></tr>
    <tr><td class="paramname">mid_freq_tasks_size</td><td>number of medium frequency tasks </td></tr>
    <tr><td class="paramname">low_freq_tasks</td><td>an array of function pointers to low frequency tasks </td></tr>
    <tr><td class="paramname">low_freq_tasks_size</td><td>number of low frequency tasks </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="background__tasks_8h.html#a0ccb08d3b903865a450dc2b4633d2d97" title="High priority task: Called every 50 us (20 kHz) ">F_TASK_FAST</a> </dd>
<dd>
<a class="el" href="background__tasks_8h.html#aadd0736a68458905fa7bca00d7f5f9be" title="Medium priority task: Called every 1 ms (1 kHz) ">F_TASK_MID</a> </dd>
<dd>
<a class="el" href="background__tasks_8h.html#a6cf2a4ef4c846f63e307f38c33bb5e30" title="Low priority task: Called every 10 ms (100 Hz) ">F_TASK_SLOW</a> </dd></dl>

</div>
</div>
<a id="a59b8f1c0605d7525987674f81ac7669b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59b8f1c0605d7525987674f81ac7669b">&#9670;&nbsp;</a></span>process_background_tasks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void process_background_tasks </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Invokes registered background tasks if certain conditions are met. </p>
<p>This procedure must be called in the main loop of the program. If the CPU timer interrupt flag of CPU timer 0 is active, it is reset and the prescaler counters are incremented. If one of the prescalers reaches its target value, it is reset as well and the corresponding tasks are executed one by one. </p><dl class="section see"><dt>See also</dt><dd><a class="el" href="background__tasks_8h.html#a0ccb08d3b903865a450dc2b4633d2d97" title="High priority task: Called every 50 us (20 kHz) ">F_TASK_FAST</a> </dd>
<dd>
<a class="el" href="background__tasks_8h.html#aadd0736a68458905fa7bca00d7f5f9be" title="Medium priority task: Called every 1 ms (1 kHz) ">F_TASK_MID</a> </dd>
<dd>
<a class="el" href="background__tasks_8h.html#a6cf2a4ef4c846f63e307f38c33bb5e30" title="Low priority task: Called every 10 ms (100 Hz) ">F_TASK_SLOW</a> </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Aug 26 2022 15:32:38 for uMIDI by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
