<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>uMIDI: /mnt/c/repositories/stuff/uMIDI/software/src/lib/gpio.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">uMIDI
   </div>
   <div id="projectbrief">The swiss army knife for quick and easy developement of MIDI applications.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_c8fa76d8dc1b9e06ff8aeb3121608b1b.html">software</a></li><li class="navelem"><a class="el" href="dir_0a6976b261bfea925410a9d3b510969e.html">src</a></li><li class="navelem"><a class="el" href="dir_85743a6d44e2a34b0cf5e56859c4c51a.html">lib</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">gpio.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>GPIO configuration and service functions.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdbool.h&gt;</code><br />
<code>#include &lt;stdint.h&gt;</code><br />
<code>#include &lt;avr/io.h&gt;</code><br />
<code>#include &lt;avr/wdt.h&gt;</code><br />
<code>#include &lt;util/delay.h&gt;</code><br />
<code>#include &quot;<a class="el" href="gpio_8h_source.html">gpio.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for gpio.c:</div>
<div class="dyncontent">
<div class="center"><img src="gpio_8c__incl.png" border="0" usemap="#_2mnt_2c_2repositories_2stuff_2uMIDI_2software_2src_2lib_2gpio_8c" alt=""/></div>
<map name="_2mnt_2c_2repositories_2stuff_2uMIDI_2software_2src_2lib_2gpio_8c" id="_2mnt_2c_2repositories_2stuff_2uMIDI_2software_2src_2lib_2gpio_8c">
<area shape="rect" id="node7" href="gpio_8h.html" title="GPIO configuration and service functions. " alt="" coords="89,109,151,136"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a02819d5cda6d2738a1fb5fd07d96f4d2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpio_8c.html#a02819d5cda6d2738a1fb5fd07d96f4d2">init_gpio_module</a> (const struct <a class="el" href="structgpio__mapping.html">gpio_mapping</a> *const mappings, const uint8_t mappings_size)</td></tr>
<tr class="separator:a02819d5cda6d2738a1fb5fd07d96f4d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac58104c3e2259427954f9c584dcdb3bc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpio_8c.html#ac58104c3e2259427954f9c584dcdb3bc">configure_gpio_pin</a> (const struct <a class="el" href="structgpio__pin.html">gpio_pin</a> *const pin, const enum <a class="el" href="gpio_8h.html#a891c93890ae66f2fe1812cc8c12ed6cf">gpio_type</a> type)</td></tr>
<tr class="memdesc:ac58104c3e2259427954f9c584dcdb3bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configures a GPIO pin.  <a href="#ac58104c3e2259427954f9c584dcdb3bc">More...</a><br /></td></tr>
<tr class="separator:ac58104c3e2259427954f9c584dcdb3bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2acd88d2a450772dafa7607409e46859"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpio_8c.html#a2acd88d2a450772dafa7607409e46859">poll_gpio_input</a> (const struct <a class="el" href="structgpio__pin.html">gpio_pin</a> pin, const enum <a class="el" href="gpio_8h.html#a891c93890ae66f2fe1812cc8c12ed6cf">gpio_type</a> type)</td></tr>
<tr class="memdesc:a2acd88d2a450772dafa7607409e46859"><td class="mdescLeft">&#160;</td><td class="mdescRight">Polls a GPIO input pin.  <a href="#a2acd88d2a450772dafa7607409e46859">More...</a><br /></td></tr>
<tr class="separator:a2acd88d2a450772dafa7607409e46859"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3de98633077557c82d5c32ba81ea261"><td class="memItemLeft" align="right" valign="top">enum <a class="el" href="gpio_8h.html#abcd81acdd66c1b3f05a6ed86346d2376">gpio_input_event</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpio_8c.html#aa3de98633077557c82d5c32ba81ea261">poll_gpio_input_timeout</a> (const struct <a class="el" href="structgpio__pin.html">gpio_pin</a> pin, const enum <a class="el" href="gpio_8h.html#a891c93890ae66f2fe1812cc8c12ed6cf">gpio_type</a> type, uint8_t timeout)</td></tr>
<tr class="memdesc:aa3de98633077557c82d5c32ba81ea261"><td class="mdescLeft">&#160;</td><td class="mdescRight">Polls a GPIO input pin with timeout.  <a href="#aa3de98633077557c82d5c32ba81ea261">More...</a><br /></td></tr>
<tr class="separator:aa3de98633077557c82d5c32ba81ea261"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:af0c823508f85ed039d59bf3b65593316"><td class="memItemLeft" align="right" valign="top">const struct <a class="el" href="structgpio.html">gpio</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpio_8c.html#af0c823508f85ed039d59bf3b65593316">gpio</a></td></tr>
<tr class="memdesc:af0c823508f85ed039d59bf3b65593316"><td class="mdescLeft">&#160;</td><td class="mdescRight">A global structure with all available GPIO pins.  <a href="#af0c823508f85ed039d59bf3b65593316">More...</a><br /></td></tr>
<tr class="separator:af0c823508f85ed039d59bf3b65593316"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>GPIO configuration and service functions. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ac58104c3e2259427954f9c584dcdb3bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac58104c3e2259427954f9c584dcdb3bc">&#9670;&nbsp;</a></span>configure_gpio_pin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void configure_gpio_pin </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structgpio__pin.html">gpio_pin</a> *&#160;</td>
          <td class="paramname"><em>pin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="gpio_8h.html#a891c93890ae66f2fe1812cc8c12ed6cf">gpio_type</a>&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Configures a GPIO pin. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pin</td><td>the GPIO pin to configure </td></tr>
    <tr><td class="paramname">type</td><td>the desired function / type of the pin </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a02819d5cda6d2738a1fb5fd07d96f4d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02819d5cda6d2738a1fb5fd07d96f4d2">&#9670;&nbsp;</a></span>init_gpio_module()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void init_gpio_module </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structgpio__mapping.html">gpio_mapping</a> *const&#160;</td>
          <td class="paramname"><em>mappings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>mappings_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a2acd88d2a450772dafa7607409e46859"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2acd88d2a450772dafa7607409e46859">&#9670;&nbsp;</a></span>poll_gpio_input()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool poll_gpio_input </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structgpio__pin.html">gpio_pin</a>&#160;</td>
          <td class="paramname"><em>pin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="gpio_8h.html#a891c93890ae66f2fe1812cc8c12ed6cf">gpio_type</a>&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Polls a GPIO input pin. </p>
<p>Automatically de-bounces the pin if it is detected as active and returns as soon as the input returns to logical 0. Warning: Uses busy waiting! </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pin</td><td>the GPIO input pin to poll </td></tr>
    <tr><td class="paramname">type</td><td>the GPIO input type (pull-up or pull-down) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>true</code> if the input pin reads logical 1 </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="gpio_8h.html#aed044c25abe0b1df0c393b202792e1c8" title="Polls a GPIO input pin with timeout. ">poll_gpio_input_timeout</a> </dd></dl>

</div>
</div>
<a id="aa3de98633077557c82d5c32ba81ea261"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3de98633077557c82d5c32ba81ea261">&#9670;&nbsp;</a></span>poll_gpio_input_timeout()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="gpio_8h.html#abcd81acdd66c1b3f05a6ed86346d2376">gpio_input_event</a> poll_gpio_input_timeout </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structgpio__pin.html">gpio_pin</a>&#160;</td>
          <td class="paramname"><em>pin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="gpio_8h.html#a891c93890ae66f2fe1812cc8c12ed6cf">gpio_type</a>&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>timeout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Polls a GPIO input pin with timeout. </p>
<p>Reads and de-bounces an input pin and measures how long it is in logical high-state continuously. After a given amount of time the function announces the event by returning <a class="el" href="gpio_8h.html#abcd81acdd66c1b3f05a6ed86346d2376af5108f6f4e44ff0c7b23044a6a693a7e" title="A GPIO input pin was seen logical &quot;high&quot; for some time. ">GPIO_INPUT_EVENT_LONG</a>. If the input pin returns to low before the timeout was reached, <a class="el" href="gpio_8h.html#abcd81acdd66c1b3f05a6ed86346d2376a424d8c658efd0972972e9cd1dcf121e1" title="A GPIO input pin was seen logical &quot;high&quot; briefly. ">GPIO_INPUT_EVENT_SHORT</a> is returned. This function uses busy waiting, so all background tasks are stalled until the timeout is reached. When the timeout is set to zero, this function blocks until the input pin reads logical low again, which is what <a class="el" href="gpio_8h.html#ace1809dc3c6683d6c4e1771f2415f3fd" title="Polls a GPIO input pin. ">poll_gpio_input</a> does. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pin</td><td>the GPIO input pin to poll </td></tr>
    <tr><td class="paramname">type</td><td>the GPIO input type (pull-up or pull-down) </td></tr>
    <tr><td class="paramname">timeout</td><td>the timeout in [s/10], or 0 for infinity </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the detected input event or <a class="el" href="gpio_8h.html#abcd81acdd66c1b3f05a6ed86346d2376a27981b260b9e4c7d02158c028bd23ada" title="Nothing happened :-(. ">GPIO_INPUT_EVENT_NONE</a> </dd></dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="af0c823508f85ed039d59bf3b65593316"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0c823508f85ed039d59bf3b65593316">&#9670;&nbsp;</a></span>gpio</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const struct <a class="el" href="structgpio.html">gpio</a> <a class="el" href="structgpio.html">gpio</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A global structure with all available GPIO pins. </p>
<p>This data structure provides a nice way to address GPIO pins. The pins are grouped into three headers with eight pins each and a group for the four solder jumpers - exactly representing the hardware interface. You can use these aliases to configure the pins you need and to get / set the state of the pin. </p><dl class="section see"><dt>See also</dt><dd><a class="el" href="gpio_8h.html#ab46ef212105c1e3c8effb03743c47626" title="Configures a GPIO pin. ">configure_gpio_pin</a> </dd>
<dd>
<a class="el" href="gpio_8h.html#adb75292e6267d8783dd9461e74883d65" title="Initializes the GPIO module. ">init_gpio_module</a> </dd>
<dd>
<a class="el" href="gpio_8h.html#a949737d45f85a5c142452765a609a109" title="Reads the state of a GPIO input pin. ">gpio_get</a> </dd>
<dd>
<a class="el" href="gpio_8h.html#a7777166735627e58a7abc5bda0556751" title="Sets a GPIO output pin to the specified state. ">gpio_set</a> </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Aug 26 2022 15:32:38 for uMIDI by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
